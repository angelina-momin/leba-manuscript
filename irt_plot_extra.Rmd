---
title: "Irt plot extra"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r factorinfo, eval=FALSE, include=FALSE}
#This chunk holds codes for item info plots clustered in factors (Not included in the manuscript)
F1.itemplots <- cowplot::plot_grid(F1.iteminfo.1,F1.iteminfo.2, F1.iteminfo.3,
                   labels = "AUTO",
                     align="v",
                     ncol = 2,
                     label_size = 12,
                     label_fontfamily = "Arial",
  label_fontface = "plain")
ggsave("Manuscript.figures/F1.itemplots.png",F1.itemplots, width = 10, height = 12, dpi = 600,bg = "white")


F2.itemplots <- cowplot::plot_grid(F2.iteminfo.1,F2.iteminfo.2, F2.iteminfo.3,
                                   F2.iteminfo.4,F2.iteminfo.5,F2.iteminfo.6,
                   labels = "AUTO",
                     align="v",
                     ncol = 2,
                     label_size = 12,
                     label_fontfamily = "Arial",
                     label_fontface = "plain")
ggsave("Manuscript.figures/F2.itemplots.png",F2.itemplots, width = 10, height = 12, dpi = 600, bg = "white")


F3.itemplots <- cowplot::plot_grid(F3.iteminfo.1,F3.iteminfo.2, F3.iteminfo.3,
                                   F3.iteminfo.4,F3.iteminfo.5,
                 labels = "AUTO",
                     align="v",
                     ncol = 2,
                     label_size = 12,
                     label_fontfamily = "Arial",
                     label_fontface = "plain")
ggsave("Manuscript.figures/F3.itemplots.png",F3.itemplots, width = 10, height = 12, dpi = 600,bg = "white")


F4.itemplots <- cowplot::plot_grid(F4.iteminfo.1,F4.iteminfo.2, F4.iteminfo.3,
                                   F4.iteminfo.4,
                   labels = "AUTO",
                     align="v",
                     ncol = 2,
                     label_size = 12,
                     label_fontfamily = "Arial",
                     label_fontface = "plain")
ggsave("Manuscript.figures/F4.itemplots.png",F4.itemplots, width = 10, height = 12, dpi = 600,bg = "white")


F5.itemplots <- cowplot::plot_grid(F1.iteminfo.1,F1.iteminfo.2, F1.iteminfo.3,
                                   
                   labels = "AUTO",
                     align="v",
                     ncol = 2,
                     label_size = 12,
                     label_fontfamily = "Arial",
                     label_fontface = "plain")
ggsave("Manuscript.figures/F5.itemplots.png",F5.itemplots, width = 10, height = 12, dpi = 600, bg = "white")

```


```{r inteminfoggplo2c, eval=FALSE, include=FALSE}
# This chinks holds code of compiled item info code created using facet wrap. (Not included in manuscript)
pacman::p_load(reshape,ggsci)
Theta <- matrix(seq(-6,6, by = .1))

##Item Extraction
F1.item1 <- extract.item(F1_fit, 1)#item number
F1.item2 <- extract.item(F1_fit, 2)
F1.item3 <- extract.item(F1_fit, 3)
F2.item1 <- extract.item(F2_fit, 1)
F2.item2 <- extract.item(F2_fit, 2)
F2.item3 <- extract.item(F2_fit, 3)
F2.item4 <- extract.item(F2_fit, 4)
F2.item5 <- extract.item(F2_fit, 5)
F2.item6 <- extract.item(F2_fit, 6)
F3.item1 <- extract.item(F3_fit, 1)
F3.item2 <- extract.item(F3_fit, 2)
F3.item3 <- extract.item(F3_fit, 3)
F3.item4 <- extract.item(F3_fit, 4)
F3.item5 <- extract.item(F3_fit, 5)
F4.item1 <- extract.item(F4_fit, 1)
F4.item2 <- extract.item(F4_fit, 2)
F4.item3 <- extract.item(F4_fit, 3)
F4.item4 <- extract.item(F4_fit, 4)
F5.item1 <- extract.item(F5_fit, 1)
F5.item2 <- extract.item(F5_fit, 2)
F5.item3 <- extract.item(F5_fit, 3)
F5.item4 <- extract.item(F5_fit, 4)
F5.item5 <- extract.item(F5_fit, 5)


##Item Info
Item16 <- iteminfo(F1.item1, Theta)
Item36 <- iteminfo(F1.item2, Theta)
Item17 <- iteminfo(F1.item3, Theta)
Item11 <- iteminfo(F2.item1, Theta)
Item10 <- iteminfo(F2.item2, Theta)
Item12 <- iteminfo(F2.item3, Theta)
Item07 <- iteminfo(F2.item4, Theta)
Item08 <- iteminfo(F2.item5, Theta)
Item09 <- iteminfo(F2.item6, Theta)
Item27 <- iteminfo(F3.item1, Theta)
Item03 <- iteminfo(F3.item2, Theta)
Item40 <- iteminfo(F3.item3, Theta)
Item30 <- iteminfo(F3.item4, Theta)
Item41 <- iteminfo(F3.item5, Theta)
Item32 <- iteminfo(F4.item1, Theta)
Item35 <- iteminfo(F4.item2, Theta)
Item38 <- iteminfo(F4.item3, Theta)
Item33 <- iteminfo(F4.item4, Theta)
Item46 <- iteminfo(F5.item1, Theta)
Item45 <- iteminfo(F5.item2, Theta)
Item25 <- iteminfo(F5.item3, Theta)
Item04 <- iteminfo(F5.item4, Theta)
Item01 <- iteminfo(F5.item5, Theta)


#Data frame

F1.item.info.data <- as.data.frame(cbind(Item16, 
                                              Item36,
                                              Item17))

F2.item.info.data <- as.data.frame(cbind(Item11, 
                                              Item10,
                                              Item12,
                                         Item07,
                                         Item08,
                                         Item09))

F3.item.info.data <- as.data.frame(cbind(Item27, 
                                              Item03,
                                              Item40,
                                         Item30,
                                        Item41))

F4.item.info.data <- as.data.frame(cbind(Item32, 
                                              Item35,
                                              Item38,
                                         Item33))
F5.item.info.data <- as.data.frame(cbind(Item46, 
                                              Item45,
                                             Item25,
                                         Item04,
                                         Item01))

F1.item.info.data.long <- melt(F1.item.info.data)
F2.item.info.data.long <- melt(F2.item.info.data)
F3.item.info.data.long <- melt(F3.item.info.data)
F4.item.info.data.long <- melt(F4.item.info.data)
F5.item.info.data.long <- melt(F5.item.info.data)



F1.item.info.data.2 <- data.frame(Theta=seq(-6,6, by = .1), F1.item.info.data.long)
F2.item.info.data.2 <- data.frame(Theta=seq(-6,6, by = .1), F2.item.info.data.long)
F3.item.info.data.2 <- data.frame(Theta=seq(-6,6, by = .1), F3.item.info.data.long)
F4.item.info.data.2 <- data.frame(Theta=seq(-6,6, by = .1), F4.item.info.data.long)
F5.item.info.data.2 <- data.frame(Theta=seq(-6,6, by = .1), F5.item.info.data.long)



pacman::p_load(ggsci)

F1.iic2 <- ggplot(F1.item.info.data.2,aes(Theta,value,col=variable))+geom_line()+apatheme+
  ggtitle("F1 Item Information Plot")+theme(legend.position = "none")+
  facet_wrap(~variable,scales = "free")+theme(strip.text.x = element_text(size = 15))+geom_hline(yintercept = .20, colour ="red")+geom_area()+ scale_color_npg()+aes(fill = as.factor(variable))+xlab(expression(theta)) + 
  ylab(expression(I(theta)))

ggsave("Manuscript.figures/F1.itemplots.png",F1.iic2, width = 12, height =8, dpi = 1200, bg ="white")


F2.iic2 <- ggplot(F2.item.info.data.2,aes(Theta,value,col=variable))+geom_line()+apatheme+
  ggtitle("F2 Item Information Plot")+theme(legend.position = "none")+
  facet_wrap(~variable,scales = "free")+theme(strip.text.x = element_text(size = 15))+
  geom_hline(yintercept = .20, colour ="red")+geom_area()+scale_color_npg()+aes(fill = as.factor(variable))+xlab(expression(theta)) + 
  ylab(expression(I(theta)))

ggsave("Manuscript.figures/F2.itemplots.png",F2.iic2, width = 12, height =8, dpi = 1200, bg ="white")


F3.iic2 <- ggplot(F3.item.info.data.2,aes(Theta,value,col=variable))+geom_line()+apatheme+
  ggtitle("F3 Item Information Plot")+theme(legend.position = "none")+
  facet_wrap(~variable,scales = "free")+theme(strip.text.x = element_text(size = 15))+
  geom_hline(yintercept = .20, colour ="red")+geom_area()+scale_color_npg()+aes(fill = as.factor(variable))+xlab(expression(theta)) + 
  ylab(expression(I(theta)))

ggsave("Manuscript.figures/F3.itemplots.png",F3.iic2, width = 12, height =8, dpi = 1200, bg ="white")


F4.iic2 <- ggplot(F4.item.info.data.2,aes(Theta,value,col=variable))+geom_line()+apatheme+
  ggtitle("F4 Item Information Plot")+theme(legend.position = "none")+
  facet_wrap(~variable,scales = "free")+theme(strip.text.x = element_text(size = 15))+
  geom_hline(yintercept = .20, colour ="red")+geom_area()+scale_color_npg()+aes(fill = as.factor(variable))+xlab(expression(theta)) + 
  ylab(expression(I(theta)))


ggsave("Manuscript.figures/F4.itemplots.png",F4.iic2, width = 12, height =8, dpi = 1200, bg ="white")


F5.iic2 <- ggplot(F5.item.info.data.2,aes(Theta,value,col=variable))+geom_line()+apatheme+
  ggtitle("F5 Item Information Plot")+theme(legend.position = "none")+
  facet_wrap(~variable,scales = "free")+theme(strip.text.x = element_text(size = 15))+
  geom_hline(yintercept = .20, colour ="red")+geom_area()+scale_color_npg()+aes(fill = as.factor(variable))+xlab(expression(theta)) + 
  ylab(expression(I(theta)))


ggsave("Manuscript.figures/F5.itemplots.png",F5.iic2, width = 12, height =8, dpi = 1200, bg ="white")


allicc <- cowplot::plot_grid(F1.iic2, F2.iic2, F3.iic2, F4.iic2, F5.iic2, labels = "AUTO",ncol=2, label_size = 15,align = "h",label_fontfamily = "Arial",
                  label_fontface = "plain")

ggsave("Manuscript.figures/allicc.png",allicc, width = 12, height =12, dpi = 1200, bg ="white")


##Creating ggplot2 based all item item info using facet wrap
alldata <- as.data.frame(cbind(Item16,Item36,Item17,Item11,Item10, Item12,Item07,Item08,Item09,Item27,Item03, Item40, Item30, Item41, Item32, Item35, Item38, Item33, Item46, Item45, Item25, Item04, Item01))

all.data.long <- melt(alldata)
alldata2 <- data.frame(Theta=seq(-6,6, by = .1), all.data.long )

allicc3 <- ggplot(alldata2,aes(Theta,value,col=variable))+geom_line()+apatheme+
  ggtitle("Item Information Plot")+theme(legend.position = "none")+
  facet_wrap(~variable,scales = "free")+theme(strip.text.x = element_text(size = 15))+
  geom_hline(yintercept = .20, colour ="red")+geom_area()+scale_color_npg()+aes(fill = as.factor(variable))+xlab(expression(theta)) + 
  ylab(expression(I(theta)))

ggsave("Manuscript.figures/allicc2.png",allicc3, width = 12, height =12, dpi = 1200, bg ="white")



```


```{r scalechar, eval=FALSE, fig.cap="Scale characteristic curve of the five fitted IRT models (a) Wearing blue light filters (b) Spending time outdoors (c) Using phone and smartwatchin bed (d) Using light before bedtime (e) Using light in the morning andduring daytime", warning=FALSE, include=FALSE, out.height="120%", out.width="100%"}
#not used in the manuscript

#Finally we generated scale characteristics curve (Figure \@ref(fig:scalechar)) which plotted estimated theta score against the expected true score. The purpose of this scale characteristics curve is to find the corresponding expected true score for the given estimated theta score of the participants. 

plot_grid(F1.scale, F1.scale,F1.scale,F1.scale,F1.scale, 
          labels = "AUTO", label_size = 10,align = "v")
```
